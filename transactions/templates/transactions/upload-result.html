{% load useful_tags %}
{% if problems|length > 0 %}
	<h2>
		There were {{ problems|length }} problem(s) with the upload. <a href="../">Back</a>
	</h2>
	<ul>
		{% for problem in problems %}
			<li>{{ problem }}</li>
		{% endfor %}
	</ul>
{% endif %}
{% if potentialDuplicates == None %}
	<h2>
		{{ totalCount|subtract:existingCount }} new transactions uploaded. {{ existingCount }} updated - <a href="../">Back</a>
	</h2>
{% elif potentialDuplicates|length == 0 %}
	<h2>
		{{ totalCount }} transactions found. {{ existingCount }} of which are updates. No potential duplicates.
	</h2>
	<input type="hidden" name="actually-upload" value="true" />
{% else %}
	<h2>
		{{ totalCount }} transactions found. The following {{ potentialDuplicates|length }} transactions already exist in the database and appear to be the same as transactions you are trying to upload (although they may be for a different account).
	</h2>
	<table class="transactions-table" border="2">
		<tr>
			<th>Account</th>
			<th>Date</th>
			<th>Description</th>
			<th>Amount</th>
			<th>Label</th>
			<th>Notes</th>
		</tr>
		{% for transaction in potentialDuplicates %}
	  		<tr duplicate-transaction>
				<td>{{ transaction.Account }}</td>
				<td>{{ transaction.Date }}</td>
				<td>{{ transaction.Description }}</td>
				<td>{{ transaction.Amount }}</td>
				<td>{{ transaction.Label }}</td>
				<td>{{ transaction.Notes }}</td>
			</tr>
		{% endfor %}
	<table>
	<input type="checkbox" name="actually-upload" value="true" id="actually-upload" /><label for="actually-upload">Upload anyway</label>
{% endif %}