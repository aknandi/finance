{% extends "transactions/template.html" %}
{% load static %}
{% load useful_tags %}

{% block content %}
	<form filter-form method="GET">
		<ul class="filter-ul">
			{{ view.getFilterForm.as_ul }}
			{% if page == None %}
				<input type="hidden" name="page" value="all">
			{% endif %}
			<li>
				<br>
				<button type="submit">Filter</button>
				<button type="button" clear-filter-button>Clear Filter</button>
				<button type="button" download-button>Download All</button>
			</li>
		</ul>
	</form>
	<ul class="filter-ul" bulk-form>
		<li>Bulk Edit (this will change all the items below)</li>
		{{ bulkForm.as_ul }}
		<li><button reset-button>Reset</button></li>
	</ul>
	<div>
		<button type="submit">Save</button>
		
		<div style="float: right">
			{{ totalFound }} transactions - 
			{% if page == None %}
				Showing all items - <a href="javascript:gotoPage(1);">Use pageination</a>
			{% else %}
				{% if page != 1 %}
					<a href="javascript:gotoPage(1);"><<-</a>
					<a href="javascript:gotoPage({{ page|add:"-1" }});"><-</a>
				{% endif %}
				<select class="page-select" onchange="gotoPage(this.value)">
				{% for i in pages %}
					{% if i == page %}
						<option value={{ i }} selected>{{ i }}</option>
					{% else %}
						<option value={{ i }}>{{ i }}</option>	
					{% endif %}
				{% endfor %}
				</select>
				of {{ pages|last }}
				{% if page != pages|last %}
					<a href="javascript:gotoPage({{ page|add:"1" }});">-></a>
					<a href="javascript:gotoPage({{ pages|last }});">->></a>
				{% endif %}
				 - <a href="javascript:gotoPage('all');">Show all</a>
			{% endif %}
		</div>
	</div>
	<form method="POST" action="./save-labels/" transactions-form>{% csrf_token %}		
		<table class="table">
	  		<tr>
				<th>Account</th>
				<th>Date</th>
				{% if singleAccount != None %}
					{% if singleAccount.OtherDate1Name != None %}
						<th>{{ singleAccount.OtherDate1Name }}</th>
					{% endif %}
					{% if singleAccount.OtherString1Name != None %}
						<th>{{ singleAccount.OtherString1Name }}</th>
					{% endif %}
				{% endif %}
				<th>Description</th>
				<th>Amount</th>
				<th></th>
				<th>Label</th>
				<th>Notes</th>
			</tr>
			{% for transaction in object_list %}
		  		<tr>
					<td>
						<input
							type="hidden"
							name="id"
							value="{{ transaction.0.id }}" />
						{{ transaction.0.Account }}
					</td>
					<td>{{ transaction.0.Date|nice_date }}</td>
					{% if singleAccount != None %}
						{% if singleAccount.OtherDate1Name != None %}
							<td>{{ transaction.0.OtherDate1|nice_date }}</td>
						{% endif %}
						{% if singleAccount.OtherString1Name != None %}
							<td>{{ transaction.0.OtherString1 }}</td>
						{% endif %}
					{% endif %}
					<td>{{ transaction.0.Description }}</td>
					<td>{{ transaction.0.Amount }}</td>
					<td>
						{% if transaction.0.Account.id == -1 %}
							<a href="./manual/{{ transaction.0.id }}">Edit</a>
						{% endif %}
					</td>
					<td>
						{{ transaction.1.Label }}
					</td>
					<td>
						{{ transaction.1.Notes }}
					</td>
				</tr>
			{% endfor %}
		</table>
		<button type="submit">Save</button>
	</form>
	<script type="text/javascript" src="{% static "transactions/index.js" %}"></script>
{% endblock %}